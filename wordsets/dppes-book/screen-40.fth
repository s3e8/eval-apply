\ LISP LIST-BUILDING WORDS IN FORTH-83

VARIABLE NIL NIL NIL ! \ THE EMPTY LIST

( #ITEMS -> ) \ #ITEMS = MAXIMUM NUMBER OF ITEMS THIS LIST

: NEWLIST CREATE HERE 2+ , NIL , 2* ALLOT ;

( @LIST -> @FIRST) \ @FIRST IS A POINTER TO FIRST ITEM OF LIST 
: FIRST @ ;

( @LIST | NIL -> FLAG) \ FLAG = TRUE IF LIST IS EMPTY 12 
: NULL @ NIL = ;

( @LIST -> @TAIL) \ @TAIL IS A POINTER TO THE TAIL OF THE LIST
: TAIL DUP NULL IF @ ELSE 2- THEN ;